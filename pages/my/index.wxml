<view class="page">
  <!-- 顶部背景 -->
  <view class="header-bg"></view>

  <!-- 用户信息卡片 -->
  <view class="user-card">
    <view class="user-info">
      <block wx:if="{{userInfo}}">
        <image 
          class="avatar" 
          src="{{userInfo.avatarUrl || userInfo.avatar}}" 
          bindtap="onUpdateAvatar"
        />
        <view class="info-content">
          <text class="name" bindtap="onUpdateNickname">
            {{userInfo.nickName || userInfo.nickname}}
          </text>
          <text class="join-time">加入时间：2024-01</text>
        </view>
      </block>
      <block wx:else>
        <image class="avatar" src="/assets/images/default-avatar.png" />
        <view class="info-content">
          <button 
            class="login-btn"
            open-type="chooseAvatar" 
            bindchooseavatar="onChooseAvatar">
            点击授权头像
          </button>
          <text class="login-desc">登录后可以体验更多功能</text>
        </view>
      </block>
    </view>

    <!-- 数据统计 -->
    <view class="stats-bar">
      <view class="stat-item">
        <text class="count">{{likesCount}}</text>
        <text class="label">点赞</text>
      </view>
      <view class="stat-item">
        <text class="count">{{collectCount}}</text>
        <text class="label">收藏</text>
      </view>
    </view>
  </view>

  <!-- 功能列表 -->
  <view class="feature-list">
    <view class="feature-item" bindtap="goToMyLikes">
      <view class="feature-left">
        <image class="feature-icon" src="/assets/images/likes.png" />
        <text class="feature-title">我的点赞</text>
      </view>
      <view class="feature-right">
        <text class="feature-count">{{likesCount}}</text>
        <text class="arrow">›</text>
      </view>
    </view>

    <view class="feature-item" bindtap="goToMyFavorites">
      <view class="feature-left">
        <image class="feature-icon" src="/assets/images/favorites.png" />
        <text class="feature-title">我的收藏</text>
      </view>
      <view class="feature-right">
        <text class="feature-count">{{collectCount}}</text>
        <text class="arrow">›</text>
      </view>
    </view>
  </view>

  <!-- 底部信息 -->
  <view class="footer-info">
    <view class="footer-decoration">
      <view class="ink-dot"></view>
    </view>
    <text class="version">浮图物相 v1.0.0</text>
    <text class="copyright">Copyright © 2024</text>
  </view>
</view>

<!-- 昵称输入框 -->
<view class="nickname-modal" wx:if="{{showNicknameInput}}">
  <view class="nickname-content">
    <text class="nickname-title">请输入昵称</text>
    <input 
      type="nickname" 
      class="nickname-input" 
      placeholder="请输入昵称" 
      model:value="{{tempNickname}}"
      focus="{{true}}"
    />
    <button 
      class="confirm-btn" 
      bindtap="{{userInfo ? 'onConfirmUpdateNickname' : 'onConfirmNickname'}}"
      disabled="{{!tempNickname}}">
      确定
    </button>
  </view>
</view>

<canvas type="2d" id="avatarCanvas" style="width: 400px; height: 400px; position: fixed; left: -500px;"></canvas> 